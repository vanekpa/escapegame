  function Scene({ page, assets, onResolve, solved, dockSize = "compact" }) {
            const BASE = "./";
            const resolveImg = (p) => (p && !/^https?:\/\//.test(p) ? BASE + p : p);

            const imgs = (page?.ui?.background_imgs?.length
                ? page.ui.background_imgs
                : page?.ui?.background_img ? [page.ui.background_img] : []
            ).map(resolveImg);

            const [idx, setIdx] = React.useState(0);
            const cur = imgs[idx] || null;

            // --- nové ovladače vzhledu z JSON ---
            const isInfo = page?.type === "info";
            const fullBleed = !!page?.ui?.full_bleed && isInfo;
            const darken = typeof page?.ui?.darken === "number"
                ? page.ui.darken
                : (isInfo ? 0.05 : 0.25); // defaulty

            // výška "plátna"
            const VIEW_H = fullBleed ? "82vh" : "60vh";

            // opožděné odhalení obsahu (bublina + dock)
            const revealMs = page?.ui?.reveal_ms ?? 0;
            const [revealed, setRevealed] = React.useState(revealMs === 0);
            React.useEffect(() => {
                if (revealMs > 0) {
                    setRevealed(false);
                    const t = setTimeout(() => setRevealed(true), revealMs);
                    return () => clearTimeout(t);
                } else {
                    setRevealed(true);
                }
            }, [page?.id]); // při každé nové stránce

            return (
                <div className="relative min-h-screen">
                    <div className="absolute left-0 right-0 top-0" style={{ height: VIEW_H }}>
                        {cur ? (
                            <img src={cur} alt="" className="w-full h-full" style={{ objectFit:"contain", objectPosition:"center" }}/>
                        ) : <div className="w-full h-full bg-slate-900" />}

                        {imgs.length > 1 && (
                            <>
                                <button
                                    onClick={() => setIdx(i => (i - 1 + imgs.length) % imgs.length)}
                                    className="absolute top-1/2 -translate-y-1/2 left-2 sm:left-4 z-10
                                               w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-black/40 text-white
                                               grid place-items-center shadow hover:bg-black/55"
                                    aria-label="Předchozí obrázek"
                                >
                                    ◀
                                </button>
                                <button
                                    onClick={() => setIdx(i => (i + 1) % imgs.length)}
                                    className="absolute top-1/2 -translate-y-1/2 right-2 sm:right-4 z-10
                                               w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-black/40 text-white
                                               grid place-items-center shadow hover:bg-black/55"
                                    aria-label="Další obrázek"
                                >
                                    ▶
                                </button>
                                <div className="absolute bottom-2 left-1/2 -translate-x-1/2 flex gap-1.5 z-10">
                                    {imgs.map((_, i) => (
                                        <button key={i} onClick={() => setIdx(i)}
                                      
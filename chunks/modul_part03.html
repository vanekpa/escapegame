?.reveal_ms ?? 0;
            const [revealed, setRevealed] = React.useState(revealMs === 0);
            React.useEffect(() => {
                if (revealMs > 0) {
                    setRevealed(false);
                    const t = setTimeout(() => setRevealed(true), revealMs);
                    return () => clearTimeout(t);
                } else {
                    setRevealed(true);
                }
            }, [page?.id]); // při každé nové stránce

            return (
                <div className="relative min-h-screen">
                    <div className="absolute left-0 right-0 top-0" style={{ height: VIEW_H }}>
                        {cur ? (
                            <img src={cur} alt="" className="w-full h-full" style={{ objectFit:"contain", objectPosition:"center" }}/>
                        ) : <div className="w-full h-full bg-slate-900" />}

                        {imgs.length > 1 && (
                            <>
                                <button
                                    onClick={() => setIdx(i => (i - 1 + imgs.length) % imgs.length)}
                                    className="absolute top-1/2 -translate-y-1/2 left-2 sm:left-4 z-10
                                               w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-black/40 text-white
                                               grid place-items-center shadow hover:bg-black/55"
                                    aria-label="Předchozí obrázek"
                                >
                                    ◀
                                </button>
                                <button
                                    onClick={() => setIdx(i => (i + 1) % imgs.length)}
                                    className="absolute top-1/2 -translate-y-1/2 right-2 sm:right-4 z-10
                                               w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-black/40 text-white
                                               grid place-items-center shadow hover:bg-black/55"
                                    aria-label="Další obrázek"
                                >
                                    ▶
                                </button>
                                <div className="absolute bottom-2 left-1/2 -translate-x-1/2 flex gap-1.5 z-10">
                                    {imgs.map((_, i) => (
                                        <button key={i} onClick={() => setIdx(i)}
                                                className={`w-2 h-2 rounded-full ${i===idx?"bg-white":"bg-white/40"}`} />
                                    ))}
                                </div>
                            </>
                        )}
                    </div>

                    {/* overlay – míra ztmavení z JSON */}
                    <div className="absolute left-0 right-0 top-0 pointer-events-none"
                         style={{ height: VIEW_H, background:`rgba(0,0,0,${darken})` }} />

                    {/* titulek scény */}
                    {page?.info?.title && (
                        <div className="absolute top-2 left-0 right-0 p-3 flex justify-center">
                            <div className="px-3 py-1 rounded-full bg-black/40 text-white text-sm backdrop-blur">
                                {page.info.title}
                            </div>
                        </div>
                    )}

                    {/* info bublina – zobraz až po reveal_ms */}
                    {isInfo && revealed && (
                        <div className="absolute left-0 right-0 flex justify-center p-6"
                             style={{ top:`calc(${VIEW_H}/2)`, transform:"translateY(-50%)" }}>
                            <InfoBubble info={page.info} onContinue={() => onResolve(true)} />
                        </div>
                    )}

                    {/* spodní dock – taky až po reveal_ms */}
                    {revealed && (
                        <BottomD